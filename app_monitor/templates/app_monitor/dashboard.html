
{% extends "core/base.html" %}

{% load static %}

{% comment %} {% static  "js/temperature_ajax.js" %} {% endcomment %}
{% block content %}

{% comment %} {% csrf_token %} {% endcomment %}
<script src="{% static 'js/temperature_ajax.js' %}"></script>
{% comment %} temperature_ajax.js scripti random olarak djangonun ürettiği değerleri 20 sn de dashboarddda basar. {% endcomment %}

<script>
const timer=() => {
  const time = new Date();
  const time_string= time.toLocaleTimeString();
  document.getElementById("saat").innerHTML=time_string;
}
  setInterval(timer,1000);
  </script>
<div class="container">

  <h3 class="bg-primary text-center">TÜM CİHAZLAR</h3> 
  <h3 ><a href="arduino_serial_local-all" target="_blank">SERI PORT CONFIG</a> </h3> 
{% comment %} {% csrf_token %} {% endcomment %}
{% comment %} <button class="btn btn-danger">BOOTSTRAP...</button> {% endcomment %}

        <div id="temperature_ajax">
            <br><br>

            <b> AJAX SICAKLIK TABLOSU</b><br>
            <b>Kayıt Sayısı Sıcaklık: </b>{{kayit_sayisi_total_ajax}} <br>
               <table class="table">
              <thead>
                 <tr>
                   <th scope="col">id</th>
                   <th scope="col">Cihaz Adı</th>
                   <th scope="col">Sıcaklık</th>
                   <th scope="col">Tarih</th>            
                 </tr>
               </thead>
             <tbody>
            
             {% for temp in tempsajax %}
               <tr>
                   {% if temp.temperature >= 45 %} <!--  if komutuyla sıcaklık 30 üstü olanlar kırmızı satır olacak --> 
                 <th scope="row" style="background-color:#FF0000">{{temp.id}}</th>
                 <td style="background-color:#FF0000">{{temp.temperature}}</td>
                <!--  <td> {{temp.date}}</td>  ilk hali saniyesiz --> 
                  <td style="background-color:#FF0000"> {{temp.date|date:'Y-m-d H:i:s'}}</td> <!--  -->        
                       {% if temp.mailSend == False %}
                       <td style="background-color:#FF0000"> {{temp.mailSend}}</td>
                       {% else %}
                       <td style="background-color:#0000FF"> {{temp.mailSend}}</td>
                       {% endif %}
                   
                   {% else %}
            
                 <th scope="row" >{{temp.id}}</th>
                 <td> {{temp.device_name}}</td>
                 <td >{{temp.temperature}}</td>
                <!--  <td> {{temp.date}}</td>  ilk hali saniyesiz --> 
                  <td > {{temp.date|date:'Y-m-d H:i:s'}}</td> <!--  -->            
                   {% endif %}               
               </tr>              
             {% endfor %}            
             </tbody>
            </table>
            </div>
            <div class="row">
              <div class="col-sm-12">
               <a href="/app_monitor/export_to_excel_all"> <button class="btn btn-success">EXCEL</button> </a> 
              </div>
            </div>
            <div class="row">
              <div class="col-sm-12 text-center mb-3">
               <!-- <br>
              <select name="" id="">
                {% for device in device_query %}
                <option value="{{device.device_name}}">
                <a href="/app_monitor/cihazlar/{{device.device_name}}">{{device.device_name}}</a> 
              </option>
                {% endfor %}
              </select> -->

              <a href="/app_monitor/cihazlar_tum" target="_blank">Tüm Cihazlar:</a> 
              
              <br>
              {% for device in device_query %}
              {% comment %} <a href="/app_monitor/cihazlar/{{device.device_name.capitalize}}" target="_blank">{{device.device_name}}</a> , {% endcomment %}
              {% comment %} <a href="/app_monitor/cihazlar/{{device.device_name.capitalize}}/port={{device.device_port}} " target="_blank">{{device.device_name}}</a> , {% endcomment %}
              {% comment %} <a href="/app_monitor/cihazlar/{{device.device_name.capitalize}}/devid={{device.pk}}/port={{device.device_port}} " target="_blank">{{device.device_name}}-{{device.device_id}} </a> , {% endcomment %}
              <a href="/app_monitor/cihazlar/{{device.device_name.capitalize}}/port={{device.device_port}}/devid={{device.pk}} " target="_blank">{{device.device_name}}-{{device.device_id}} </a> ,
              {% endfor %}
              <br>
              <!-- Cihazlar{{device_query}} -->             
              </div>
              </div>
        </div>
{% endblock content %}
